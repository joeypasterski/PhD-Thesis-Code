This code was developed for my PhD thesis. 
